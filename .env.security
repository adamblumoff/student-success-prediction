# Security Configuration for Student Success Prediction System
# Copy this to .env and update with your secure values

# ==========================================
# AUTHENTICATION & AUTHORIZATION
# ==========================================

# JWT Configuration
JWT_SECRET_KEY=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRATION_HOURS=24

# API Keys (generate strong random keys for production)
ADMIN_API_KEY=admin-super-secure-key-change-me
TEACHER_API_KEY=teacher-secure-key-change-me
READONLY_API_KEY=readonly-secure-key-change-me

# Development mode (set to false in production)
DEVELOPMENT_MODE=true

# ==========================================
# NETWORK SECURITY
# ==========================================

# Allowed hosts (comma-separated)
ALLOWED_HOSTS=localhost,127.0.0.1,yourdomain.com

# Allowed CORS origins (comma-separated)
ALLOWED_ORIGINS=http://localhost:8001,https://yourdomain.com

# ==========================================
# RATE LIMITING
# ==========================================

# Rate limits (requests per time window in seconds)
RATE_LIMIT_DEFAULT=100,3600
RATE_LIMIT_UPLOAD=10,3600
RATE_LIMIT_ANALYSIS=50,3600
RATE_LIMIT_AUTH=5,300

# ==========================================
# FILE UPLOAD SECURITY
# ==========================================

# Maximum file size in bytes (10MB)
MAX_FILE_SIZE=10485760

# Allowed file types (comma-separated MIME types)
ALLOWED_MIME_TYPES=text/csv,application/csv,text/plain

# ==========================================
# DATABASE SECURITY
# ==========================================

# Database URL with strong credentials
DATABASE_URL=sqlite:///./secure_mvp_data.db

# For PostgreSQL in production:
# DATABASE_URL=postgresql://username:strong_password@localhost/dbname

# ==========================================
# LOGGING & MONITORING
# ==========================================

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Enable security event logging
SECURITY_LOGGING=true

# Log file path
LOG_FILE=logs/security.log

# ==========================================
# SSL/TLS CONFIGURATION
# ==========================================

# SSL certificate paths (for HTTPS)
SSL_CERT_PATH=/path/to/cert.pem
SSL_KEY_PATH=/path/to/key.pem

# Force HTTPS redirect
FORCE_HTTPS=false

# ==========================================
# SESSION SECURITY
# ==========================================

# Session timeout in minutes
SESSION_TIMEOUT=30

# Secure cookie settings
SECURE_COOKIES=true
SAMESITE_COOKIES=strict

# ==========================================
# MONITORING & ALERTING
# ==========================================

# Webhook URL for security alerts
SECURITY_WEBHOOK_URL=https://your-monitoring-system.com/webhook

# Email for security notifications
SECURITY_EMAIL=security@yourdomain.com

# ==========================================
# PRODUCTION SECURITY CHECKLIST
# ==========================================

# Before deploying to production:
# 1. Change all default keys and passwords
# 2. Set DEVELOPMENT_MODE=false
# 3. Configure proper ALLOWED_HOSTS and ALLOWED_ORIGINS
# 4. Set up HTTPS with valid SSL certificates
# 5. Configure proper database with strong credentials
# 6. Set up security monitoring and alerting
# 7. Regular security audits and dependency updates
# 8. Implement backup and disaster recovery
# 9. Configure firewall and network security
# 10. Train team on security best practices